# ุฑุงูููุง ุชูุธู SMS.ir ุจุฑุง ูพุฑูฺู SalamatLab

## ๐ฑ ุชูุธูุงุช SMS.ir ูุทุงุจู ูุณุชูุฏุงุช ุฑุณู

### ูุฑุญูู 1: ุฏุฑุงูุช API Key

1. ูุงุฑุฏ ูพูู SMS.ir ุฎูุฏ ุดูุฏ
2. ุจู ุจุฎุด **"ุจุฑูุงููโููุณุงู"** > **"ูุณุช ฺฉูุฏูุง API"** ุจุฑูุฏ
3. API Key ุฎูุฏ ุฑุง ฺฉูพ ฺฉูุฏ

### ูุฑุญูู 2: ุงุฌุงุฏ Templates ุฏุฑ ูพูู SMS.ir

ุฏุฑ ุจุฎุด **"ุงุฑุณุงู ุณุฑุน"** ูพูู ุฎูุฏุ templates ุฒุฑ ุฑุง ุงุฌุงุฏ ฺฉูุฏ:

#### ๐ Template ฺฉุฏ OTP (ุงุฌุจุงุฑ):
```
ฺฉุฏ ุชุงุฏ ุดูุง: #Code#
ุขุฒูุงุดฺฏุงู ุณูุงูุช
```
- **ูพุงุฑุงูุชุฑ**: `Code`
- **ุงุณุชูุงุฏู**: ูุฑูุฏ ฺฉุงุฑุจุฑุงู ู ุชุงุฏ ุดูุงุฑู ุชููู

#### โ Template ุชุงุฏ ฺฺฉุงูพ:
```
ุณูุงู #NAME# ุนุฒุฒ
ุฏุฑุฎูุงุณุช #CHECKUP# ุดูุง ุจุง ููููุช ุซุจุช ุดุฏ.
ุขุฒูุงุดฺฏุงู ุณูุงูุช
```
- **ูพุงุฑุงูุชุฑูุง**: `NAME`, `CHECKUP`

#### โ Template ุชุงุฏ ุนููู:
```
ุณูุงู #NAME# ุนุฒุฒ
ุฏุฑุฎูุงุณุช ุดูุง ุจุง ููููุช ุซุจุช ุดุฏ. ุจู ุฒูุฏ ุชูุงุณ ูโฺฏุฑู.
ุขุฒูุงุดฺฏุงู ุณูุงูุช
```
- **ูพุงุฑุงูุชุฑ**: `NAME`

#### ๐ Template ุงุทูุงุนโุฑุณุงู ููฺฉุงุฑ:
```
ุฏุฑุฎูุงุณุช ุฌุฏุฏ ุซุจุช ุดุฏ.
ูุดุงูุฏู: #LINK#
ุขุฒูุงุดฺฏุงู ุณูุงูุช
```
- **ูพุงุฑุงูุชุฑ**: `LINK`

### ูุฑุญูู 3: ุชูุธู Environment Variables

ุฏุฑ ูพูู ูุงุณุช ุฎูุฏุ ุงู ูุชุบุฑูุง ุฑุง ุชูุธู ฺฉูุฏ:

```bash
# ุงุทูุงุนุงุช ุงุตู SMS.ir
SMSIR_API_KEY=your_api_key_from_sms_ir_panel
SMSIR_TEMPLATE_ID=your_otp_template_id
SMSIR_TEMPLATE_PARAM_NAME=Code

# Templates ุชุงุฏ (Template IDs ุฑุง ุงุฒ ูพูู SMS.ir ุจฺฏุฑุฏ)
CHECKUP_CONFIRM_TEMPLATE_ID=123456
CHECKUP_CONFIRM_NAME_PARAM=NAME
CHECKUP_CONFIRM_TITLE_PARAM=CHECKUP

SMSIR_CONFIRM_TEMPLATE_ID=123457
SMSIR_CONFIRM_PARAM_NAME=NAME

# Template ุงุทูุงุนโุฑุณุงู ููฺฉุงุฑ
SMSIR_STAFF_TEMPLATE_ID=123458
SMSIR_STAFF_PARAM_NAME=LINK
STAFF_NOTIFY_MOBILE=09123456789

# Templates ุงุถุงู (ุงุฎุชุงุฑ)
FEEDBACK_CONFIRM_TEMPLATE_ID=123459
CAREERS_CONFIRM_TEMPLATE_ID=123460
CONTACT_CONFIRM_TEMPLATE_ID=123461
```

### ูุฑุญูู 4: ุชุณุช ุณุณุชู

#### ุชุณุช ฺฉุงููฺฏ:
```
https://yourdomain.com/api/test-sms.php
```

#### ุชุณุช Live ุงุฑุณุงู:
```
https://yourdomain.com/api/test-sms.php?live_test=1&test_phone=09123456789
```

## ๐ง ูุดุฎุตุงุช ูู API

### Endpoint:
```
POST https://api.sms.ir/v1/send/verify
```

### Headers:
```
Content-Type: application/json
x-api-key: YOUR_API_KEY
Accept: application/json
```

### Request Body:
```json
{
    "mobile": "09123456789",
    "templateId": 123456,
    "parameters": [
        {
            "name": "Code",
            "value": "123456"
        }
    ]
}
```

### Response:
```json
{
    "status": 1,
    "message": "ูููู",
    "data": {
        "messageId": 89545112,
        "cost": 1.0
    }
}
```

## ๐ ูุญูู ุงุณุชูุงุฏู ุฏุฑ ฺฉุฏ

### ุงุฑุณุงู OTP:
```php
// ุฏุฑ ูุงูโูุง PHP ููุฌูุฏ
$result = sendOtpSms('09123456789', '123456');
```

### ุงุฑุณุงู ุชุงุฏ ฺฺฉุงูพ:
```php
$result = sendTemplateSMS('09123456789', CHECKUP_CONFIRM_TEMPLATE_ID, [
    'NAME' => 'ุงุญูุฏ ูุญูุฏ',
    'CHECKUP' => 'ฺฺฉุงูพ ุนููู'
]);
```

### ุงุฑุณุงู ุชุงุฏ ุนููู:
```php
$result = sendTemplateSMS('09123456789', SMSIR_CONFIRM_TEMPLATE_ID, [
    'NAME' => 'ุงุญูุฏ ูุญูุฏ'
]);
```

## ๐ ุนุจโุงุจ

### ูุดฺฉูุงุช ุฑุงุฌ:

#### 1. **API Key Invalid**
- โ ุจุฑุฑุณ ฺฉูุฏ API Key ุงุฒ ูพูู SMS.ir ฺฉูพ ุดุฏู
- โ ูุถุง ุฎุงู ุงุถุงู ูุจุงุดุฏ
- โ ูุชุบุฑ `SMSIR_API_KEY` ุฏุฑ environment ุชูุธู ุดุฏู

#### 2. **Template Not Found**
- โ Template ID ุตุญุญ ุงุณุชุ
- โ Template ุฏุฑ ูพูู SMS.ir ูุนุงู ุงุณุชุ
- โ ูุงู ูพุงุฑุงูุชุฑูุง ุฏููุงู ูุทุงุจู Template ุงุณุชุ

#### 3. **SMS Not Delivered**
- โ ุดูุงุฑู ููุจุงู ุตุญุญ ุงุณุชุ
- โ ุงุนุชุจุงุฑ SMS.ir ฺฉุงู ุงุณุชุ
- โ ุฎุท ุงุฑุณุงู ูุณุฏูุฏ ูุดุฏูุ

#### 4. **HTTP 401 Error**
- โ API Key ุงุดุชุจุงู ุงุณุช
- โ Header `x-api-key` ุตุญุญ ุงุฑุณุงู ููโุดูุฏ

#### 5. **HTTP 400 Error**
- โ ูุฑูุช JSON ุงุดุชุจุงู ุงุณุช
- โ Template ID ุง ูพุงุฑุงูุชุฑูุง ูุงุฏุฑุณุช

### ุจุฑุฑุณ Logs:

Logs ุฏุฑ ูุงูโูุง ุฒุฑ ุฐุฎุฑู ูโุดููุฏ:
- `/tmp/salamat-app.log` (ูุงฺฏโูุง ุนููู)
- Console log ุฏุฑ browser (ุฎุทุงูุง JavaScript)

### ููููู Response ูุง ุฑุงุฌ:

#### ูููู:
```json
{
    "status": 1,
    "message": "ูููู",
    "data": {
        "messageId": 89545112,
        "cost": 1.0
    }
}
```

#### ุฎุทุง - API Key ุงุดุชุจุงู:
```json
{
    "status": 0,
    "message": "ฺฉูุฏ API ูุงูุนุชุจุฑ ุงุณุช"
}
```

#### ุฎุทุง - Template ูุงูุนุชุจุฑ:
```json
{
    "status": 0,
    "message": "ูุงูุจ ุงูุช ูุดุฏ"
}
```

## ๐ก ูฺฉุงุช ููู

1. **Rate Limiting**: SMS.ir ูุญุฏูุฏุช ุงุฑุณุงู ุฏุงุฑุฏ - ุงุฒ ุงุฑุณุงู ูพุงูพ ุฌููฺฏุฑ ฺฉูุฏ
2. **Cost Management**: ูุฑ SMS ูุฒูู ุฏุงุฑุฏ - ุบุฑุถุฑูุฑ ุงุฑุณุงู ูฺฉูุฏ  
3. **Template Approval**: Templates ููฺฉู ุงุณุช ูุงุฒ ุจู ุชุงุฏ ุฏุงุดุชู ุจุงุดูุฏ
4. **Parameter Length**: ูพุงุฑุงูุชุฑูุง ุญุฏุงฺฉุซุฑ 25 ฺฉุงุฑุงฺฉุชุฑ
5. **SSL/TLS**: ุงุชุตุงู HTTPS ุงุฌุจุงุฑ ุงุณุช

## ๐ ูพุดุชุจุงู

### ุฎุทุงูุง ูู:
1. ูุงู `test-sms.php` ุฑุง ฺฺฉ ฺฉูุฏ
2. Logs ุฑุง ุจุฑุฑุณ ฺฉูุฏ
3. Template IDs ุฑุง ุชุงุฏ ฺฉูุฏ
4. API Key ุฑุง ุฏูุจุงุฑู ุจุฑุฑุณ ฺฉูุฏ

### ุชูุงุณ ุจุง SMS.ir:
- **ูพูู ูพุดุชุจุงู**: ุฏุฑ ุณุงุช SMS.ir
- **ูุณุชูุฏุงุช**: https://api.sms.ir/
- **ุชฺฉุช**: ุงุฒ ูพูู ฺฉุงุฑุจุฑ

---

**ูฺฉุชู**: ุงู ุฑุงูููุง ุจุฑ ุงุณุงุณ ูุณุชูุฏุงุช ุฑุณู SMS.ir ููุดุชู ุดุฏู ู ฺฉุงููุงู ุณุงุฒฺฏุงุฑ ุงุณุช.
